<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marrow Pathology Report Template</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Marrow Pathology Report Template</h1>
        </header>

        <div class="main-content">
            <!-- Epic Data Parser Section -->
            <div class="section-card">
                <div class="section-header">
                    <h2>Epic Data Parser</h2>
                </div>
                <div class="section-content">
                    <div class="form-group">
                        <label for="epic-data-input">Paste CBC, Auto Diff, and Manual Diff data from Epic (Whole Column)</label>
                        <textarea id="epic-data-input" placeholder="Paste all CBC and differential data here...&#10;&#10;Example:&#10;CBC 04/15/2024&#10;WBC: 8.5 K/uL&#10;HGB: 12.3 g/dL&#10;HCT: 36.8%&#10;PLT: 245 K/uL&#10;&#10;Auto Differential:&#10;Neutrophils: 62.5%&#10;Lymphocytes: 28.3%&#10;Monocytes: 7.2%&#10;&#10;Manual Differential:&#10;Polys: 60%&#10;Bands: 3%&#10;Lymphs: 25%&#10;Blasts: 0%"></textarea>
                    </div>
                    <div class="form-row">
                        <button type="button" class="btn btn-primary" onclick="parseEpicData()">Parse Data</button>
                        <button type="button" class="btn btn-secondary" onclick="clearEpicData()">Clear</button>
                    </div>
                    <div id="parsing-results" class="parsing-results" style="display: none;">
                        <h4>Parsed Results:</h4>
                        <div id="parsed-cbc" class="parsed-section">
                            <h5>CBC Results:</h5>
                            <div id="cbc-values"></div>
                        </div>
                        <div id="parsed-auto-diff" class="parsed-section">
                            <div id="auto-diff-values"></div>
                        </div>
                        <div id="parsed-manual-diff" class="parsed-section">
                            <div id="manual-diff-values"></div>
                        </div>
                        <div id="parsing-errors" class="parsing-errors" style="display: none;">
                            <h5>Parsing Errors:</h5>
                            <div id="error-messages"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Core Biopsy Section -->
            <div class="section-card" id="core-section">
                <div class="section-header">
                    <h2>Core Biopsy</h2>
                </div>
                <div class="section-content">
                    <div class="subsection">
                        <h3>Adequacy</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Biopsy adequacy</label>
                                    <div class="radio-group">
                                        <label><input type="radio" name="biopsy-adequacy" value="Adequate"> Adequate</label>
                                        <label><input type="radio" name="biopsy-adequacy" value="Limited" checked> Limited</label>
                                        <label><input type="radio" name="biopsy-adequacy" value="Inadequate"> Inadequate</label>
                                    </div>
                            </div>
                            <div class="form-group">
                                <label for="limitations">Describe limitations</label>
                                <textarea id="limitations" placeholder="e.g. fragmented">fragmented</textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="subsection">
                        <h3>Cellularity</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="cellularity">Cellularity</label>
                                <input type="text" id="cellularity" placeholder="%, can be a range">
                            </div>
                            <div class="form-group">
                                <label>Age-adjusted cellularity</label>
                                <div class="radio-group">
                                    <label><input type="radio" name="age-cellularity" value="normocellular"> normocellular</label>
                                    <label><input type="radio" name="age-cellularity" value="hypocellular"> hypocellular</label>
                                    <label><input type="radio" name="age-cellularity" value="hypercellular"> hypercellular</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="subsection">
                        <h3>Myeloid:Erythroid Ratio</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Myeloid:Erythroid (M:E) ratio</label>
                                <div class="radio-group">
                                    <label><input type="radio" name="me-ratio" value="normal"> normal</label>
                                    <label><input type="radio" name="me-ratio" value="increased"> increased</label>
                                    <label><input type="radio" name="me-ratio" value="decreased"> decreased</label>
                                    <label><input type="radio" name="me-ratio" value="reversed"> reversed</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Core Biopsy - Cell Populations -->
                    <div class="subsection">
                        <h3>Cell Populations</h3>
                        
                        <!-- Detailed Descriptors Toggle -->
                        <div class="form-group">
                            <label class="toggle-label">
                                <input type="checkbox" id="core-abnormal-toggle" class="abnormal-toggle">
                                <span class="toggle-text">Show Detailed Descriptors</span>
                            </label>
                        </div>
                        
                        <!-- Core Biopsy - Myeloid Lineage -->
                        <div class="cell-type-section" id="core-myeloid">
                            <h4>Myeloid Lineage</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Myeloid lineage</label>
                                    <div class="radio-group">
                                        <label><input type="radio" name="core-myeloid" value="complete"> complete</label>
                                        <label><input type="radio" name="core-myeloid" value="left-shifted"> left-shifted</label>
                                        <label><input type="radio" name="core-myeloid" value="dysplastic/atypical" checked> dysplastic/atypical</label>
                                        <label><input type="radio" name="core-myeloid" value="maturation is complete and without significant abnormalities"> maturation is complete and without significant abnormalities</label>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Detailed Core Biopsy Myeloid Descriptors -->
                            <div class="descriptor-section collapsible" id="core-myeloid-descriptors">
                                <div class="section-header-toggle">
                                    <h5>ðŸ“‹ Detailed Descriptors</h5>
                                    <button class="toggle-btn" data-target="core-myeloid-descriptors">â–¼</button>
                                </div>
                                <div class="collapsible-content">
                                    <div class="descriptor-category">
                                        <h6>Cellularity & Maturation</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="core-myel-cellularity" value="Left shift (increased early myeloid precursors)"> Left shift (increased early myeloid precursors)</label>
                                            <label><input type="checkbox" name="core-myel-cellularity" value="Maturation arrest"> Maturation arrest</label>
                                            <label><input type="checkbox" name="core-myel-cellularity" value="Normal trilineage hematopoiesis"> Normal trilineage hematopoiesis</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Nuclear Features</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="core-myel-nuclear" value="Hyposegmentation (e.g., pseudoâ€“Pelger-HuÃ«t anomaly)"> Hyposegmentation (e.g., pseudoâ€“Pelger-HuÃ«t anomaly)</label>
                                            <label><input type="checkbox" name="core-myel-nuclear" value="Hypersegmentation"> Hypersegmentation</label>
                                            <label><input type="checkbox" name="core-myel-nuclear" value="Irregular nuclear shapes"> Irregular nuclear shapes</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Cytoplasmic Features</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="core-myel-cytoplasm" value="Hypogranular cytoplasm"> Hypogranular cytoplasm</label>
                                            <label><input type="checkbox" name="core-myel-cytoplasm" value="Toxic granulation"> Toxic granulation</label>
                                            <label><input type="checkbox" name="core-myel-cytoplasm" value="Auer rods (pathologic finding)"> Auer rods (pathologic finding)</label>
                                            <label><input type="checkbox" name="core-myel-cytoplasm" value="Cytoplasmic vacuolization"> Cytoplasmic vacuolization</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Other</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="core-myel-other" value="Dysmyelopoiesis"> Dysmyelopoiesis</label>
                                            <label><input type="checkbox" name="core-myel-other" value="Abnormal granule distribution"> Abnormal granule distribution</label>
                                             <label><input type="checkbox" name="core-myel-other" value="Abnormal localization of immature precursors (ALIP)"> Abnormal localization of immature precursors (ALIP)</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="core-myeloid-description">Additional myeloid description</label>
                                <textarea id="core-myeloid-description" placeholder="Additional findings or specific observations"></textarea>
                            </div>
                        </div>
                        
                        <!-- Core Biopsy - Erythroid Lineage -->
                        <div class="cell-type-section" id="core-erythroid">
                            <h4>Erythroid Lineage</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Erythroid lineage</label>
                                    <div class="radio-group">
                                        <label><input type="radio" name="core-erythroid" value="complete"> complete</label>
                                        <label><input type="radio" name="core-erythroid" value="left-shifted"> left-shifted</label>
                                        <label><input type="radio" name="core-erythroid" value="dysplastic/atypical" checked> dysplastic/atypical</label>
                                        <label><input type="radio" name="core-erythroid" value="maturation is complete and without significant abnormalities"> maturation is complete and without significant abnormalities</label>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Detailed Core Biopsy Erythroid Descriptors -->
                            <div class="descriptor-section collapsible" id="core-erythroid-descriptors">
                                <div class="section-header-toggle">
                                    <h5>ðŸ“‹ Detailed Descriptors</h5>
                                    <button class="toggle-btn" data-target="core-erythroid-descriptors">â–¼</button>
                                </div>
                                <div class="collapsible-content">
                                    <div class="descriptor-category">
                                        <h6>Cell Size & Shape</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="core-ery-size" value="Normoblastic maturation"> Normoblastic maturation</label>
                                            <label><input type="checkbox" name="core-ery-size" value="Megaloblastic change (large cells with open chromatin)"> Megaloblastic change (large cells with open chromatin)</label>
                                             <label><input type="checkbox" name="core-ery-size" value="Microcytic erythroblasts"> Microcytic erythroblasts</label>
                                             <label><input type="checkbox" name="core-ery-size" value="Macrocytic erythroblasts"> Macrocytic erythroblasts</label>
                                            <label><input type="checkbox" name="core-ery-size" value="Irregular nuclear shapes (nuclear budding, multinuclearity)"> Irregular nuclear shapes (nuclear budding, multinuclearity)</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Nuclear Features</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="core-ery-nuclear" value="Open chromatin with nucleoli (immature)"> Open chromatin with nucleoli (immature)</label>
                                            <label><input type="checkbox" name="core-ery-nuclear" value="Hyperchromatic nuclei"> Hyperchromatic nuclei</label>
                                            <label><input type="checkbox" name="core-ery-nuclear" value="Fragmented nuclei"> Fragmented nuclei</label>
                                            <label><input type="checkbox" name="core-ery-nuclear" value="Nuclear budding / bridging"> Nuclear budding / bridging</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Cytoplasmic Features</h6>
                                        <div class="checkbox-grid compact">
                                             <label><input type="checkbox" name="core-ery-cytoplasm" value="Basophilic cytoplasm"> Basophilic cytoplasm</label>
                                             <label><input type="checkbox" name="core-ery-cytoplasm" value="Polychromatic cytoplasm"> Polychromatic cytoplasm</label>
                                             <label><input type="checkbox" name="core-ery-cytoplasm" value="Orthochromatic cytoplasm"> Orthochromatic cytoplasm</label>
                                            <label><input type="checkbox" name="core-ery-cytoplasm" value="Vacuolated cytoplasm"> Vacuolated cytoplasm</label>
                                            <label><input type="checkbox" name="core-ery-cytoplasm" value="Reduced hemoglobinization (hypochromia)"> Reduced hemoglobinization (hypochromia)</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Maturation Pattern</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="core-ery-maturation" value="Dyserythropoiesis"> Dyserythropoiesis</label>
                                            <label><input type="checkbox" name="core-ery-maturation" value="Shift to early or late precursors"> Shift to early or late precursors</label>
                                            <label><input type="checkbox" name="core-ery-maturation" value="Disordered maturation"> Disordered maturation</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="core-erythroid-description">Additional erythroid description</label>
                                <textarea id="core-erythroid-description" placeholder="Additional findings or specific observations"></textarea>
                            </div>
                        </div>
                        
                        <!-- Core Biopsy - Megakaryocytes -->
                        <div class="cell-type-section" id="core-megakaryocytes">
                            <h4>Megakaryocytes</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Megakaryocytes</label>
                                    <div class="radio-group">
                                        <label><input type="radio" name="core-megakaryocytes" value="adequate"> adequate</label>
                                        <label><input type="radio" name="core-megakaryocytes" value="decreased"> decreased</label>
                                        <label><input type="radio" name="core-megakaryocytes" value="increased" checked> increased</label>
                                        <label><input type="radio" name="core-megakaryocytes" value="maturation is complete and without significant abnormalities"> maturation is complete and without significant abnormalities</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="core-megakaryocyte-ihc">Megakaryocyte IHC, if performed</label>
                                    <textarea id="core-megakaryocyte-ihc"></textarea>
                                </div>
                            </div>
                            
                            <!-- Detailed Core Biopsy Megakaryocyte Descriptors -->
                            <div class="descriptor-section collapsible" id="core-megakaryocyte-descriptors">
                                <div class="section-header-toggle">
                                    <h5>ðŸ“‹ Detailed Descriptors</h5>
                                    <button class="toggle-btn" data-target="core-megakaryocyte-descriptors">â–¼</button>
                                </div>
                                <div class="collapsible-content">
                                    <div class="descriptor-category">
                                        <h6>Cell Size & Number</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="core-meg-size" value="Small / Micromegakaryocytes"> Small / Micromegakaryocytes</label>
                                            <label><input type="checkbox" name="core-meg-size" value="Large / Giant megakaryocytes"> Large / Giant megakaryocytes</label>
                                             <label><input type="checkbox" name="core-meg-size" value="Increased megakaryocyte density"> Increased megakaryocyte density</label>
                                             <label><input type="checkbox" name="core-meg-size" value="Decreased megakaryocyte density"> Decreased megakaryocyte density</label>
                                             <label><input type="checkbox" name="core-meg-size" value="Clustered distribution"> Clustered distribution</label>
                                             <label><input type="checkbox" name="core-meg-size" value="Scattered distribution"> Scattered distribution</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Nuclear Features</h6>
                                        <div class="checkbox-grid compact">
                                             <label><input type="checkbox" name="core-meg-nuclear" value="Hypolobated nuclei"> Hypolobated nuclei</label>
                                             <label><input type="checkbox" name="core-meg-nuclear" value="Monolobated nuclei"> Monolobated nuclei</label>
                                            <label><input type="checkbox" name="core-meg-nuclear" value="Hyperlobated nuclei"> Hyperlobated nuclei</label>
                                             <label><input type="checkbox" name="core-meg-nuclear" value="Round nuclei"> Round nuclei</label>
                                             <label><input type="checkbox" name="core-meg-nuclear" value="Oval nuclei"> Oval nuclei</label>
                                            <label><input type="checkbox" name="core-meg-nuclear" value="Bulbous nuclear projections"> Bulbous nuclear projections</label>
                                            <label><input type="checkbox" name="core-meg-nuclear" value="Separated nuclear lobes (pawn ball appearance)"> Separated nuclear lobes ("pawn ball" appearance)</label>
                                            <label><input type="checkbox" name="core-meg-nuclear" value="Irregular nuclear contours"> Irregular nuclear contours</label>
                                             <label><input type="checkbox" name="core-meg-nuclear" value="Hyperchromatic chromatin"> Hyperchromatic chromatin</label>
                                             <label><input type="checkbox" name="core-meg-nuclear" value="Open chromatin"> Open chromatin</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Cytoplasmic Features</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="core-meg-cytoplasm" value="Basophilic cytoplasm"> Basophilic cytoplasm</label>
                                            <label><input type="checkbox" name="core-meg-cytoplasm" value="Pale or granular cytoplasm"> Pale or granular cytoplasm</label>
                                             <label><input type="checkbox" name="core-meg-cytoplasm" value="Abundant cytoplasm"> Abundant cytoplasm</label>
                                             <label><input type="checkbox" name="core-meg-cytoplasm" value="Scant cytoplasm"> Scant cytoplasm</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Other</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="core-meg-other" value="Dysplastic megakaryocytes"> Dysplastic megakaryocytes</label>
                                            <label><input type="checkbox" name="core-meg-other" value="Bare megakaryocyte nuclei (naked nuclei)"> Bare megakaryocyte nuclei (naked nuclei)</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="core-megakaryocyte-description">Additional megakaryocyte description</label>
                                <textarea id="core-megakaryocyte-description" placeholder="Additional findings or specific observations"></textarea>
                            </div>
                        </div>
                        
                        <!-- Core Biopsy - Lymphocytes & Plasma Cells -->
                        <div class="cell-type-section" id="core-lymphocytes">
                            <h4>Lymphocytes & Plasma Cells</h4>
                            
                            <!-- Detailed Core Biopsy Lymphocytes Descriptors -->
                            <div class="descriptor-section collapsible" id="core-lymphocytes-descriptors">
                                <div class="section-header-toggle">
                                    <h5>ðŸ“‹ Detailed Descriptors</h5>
                                    <button class="toggle-btn" data-target="core-lymphocytes-descriptors">â–¼</button>
                                </div>
                                <div class="collapsible-content">
                                    <div class="descriptor-category">
                                        <h6>Cell Size & Type</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="core-lymph-size" value="Small mature lymphocytes"> Small mature lymphocytes</label>
                                            <label><input type="checkbox" name="core-lymph-size" value="Intermediate / large lymphoid cells"> Intermediate / large lymphoid cells</label>
                                            <label><input type="checkbox" name="core-lymph-size" value="Reactive lymphocytes"> Reactive lymphocytes</label>
                                            <label><input type="checkbox" name="core-lymph-size" value="Atypical lymphocytes"> Atypical lymphocytes</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Nuclear Features</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="core-lymph-nuclear" value="Round nuclear contours"> Round nuclear contours</label>
                                            <label><input type="checkbox" name="core-lymph-nuclear" value="Irregular nuclear contours"> Irregular nuclear contours</label>
                                            <label><input type="checkbox" name="core-lymph-nuclear" value="Clumped chromatin (typical of mature cells)"> Clumped chromatin (typical of mature cells)</label>
                                            <label><input type="checkbox" name="core-lymph-nuclear" value="Open chromatin with nucleoli (atypical / blasts)"> Open chromatin with nucleoli (atypical / blasts)</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Cytoplasmic Features</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="core-lymph-cytoplasm" value="Scant basophilic cytoplasm (small lymphocytes)"> Scant basophilic cytoplasm (small lymphocytes)</label>
                                            <label><input type="checkbox" name="core-lymph-cytoplasm" value="Perinuclear hof (plasma cells)"> Perinuclear hof (plasma cells)</label>
                                            <label><input type="checkbox" name="core-lymph-cytoplasm" value="Plasmacytoid features"> Plasmacytoid features</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Distribution</h6>
                                        <div class="checkbox-grid compact">
                                             <label><input type="checkbox" name="core-lymph-distribution" value="Interstitial aggregates"> Interstitial aggregates</label>
                                             <label><input type="checkbox" name="core-lymph-distribution" value="Nodular aggregates"> Nodular aggregates</label>
                                             <label><input type="checkbox" name="core-lymph-distribution" value="Paratrabecular aggregates"> Paratrabecular aggregates</label>
                                             <label><input type="checkbox" name="core-lymph-distribution" value="Diffuse aggregates"> Diffuse aggregates</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="core-lymphocytes-description">Additional lymphocytes & plasma cells description</label>
                                <textarea id="core-lymphocytes-description" placeholder="Additional findings or specific observations"></textarea>
                            </div>
                        </div>

                        <!-- Core Biopsy - Architecture & Other Findings -->
                        <div class="cell-type-section" id="core-architecture">
                            <h4>Architecture & Other Findings</h4>
                            <div class="descriptor-section collapsible" id="core-architecture-descriptors">
                                <div class="section-header-toggle">
                                    <h5>ðŸ“‹ Detailed Descriptors</h5>
                                    <button class="toggle-btn" data-target="core-architecture-descriptors">â–¼</button>
                                </div>
                                <div class="collapsible-content">
                                    <div class="descriptor-category">
                                        <h6>Lymphoid Aggregates</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="core-arch-aggregates" value="Lymphoid aggregates present"> Lymphoid aggregates present</label>
                                            <label><input type="checkbox" name="core-arch-aggregates" value="Paratrabecular aggregates"> Paratrabecular aggregates</label>
                                            <label><input type="checkbox" name="core-arch-aggregates" value="Interstitial aggregates"> Interstitial aggregates</label>
                                            <label><input type="checkbox" name="core-arch-aggregates" value="Nodular aggregates"> Nodular aggregates</label>
                                            <label><input type="checkbox" name="core-arch-aggregates" value="Diffuse aggregates"> Diffuse aggregates</label>
                                        </div>
                                    </div>

                                    <div class="descriptor-category">
                                        <h6>Hemosiderin-laden Macrophages</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="core-arch-hemosiderin" value="Rare"> Rare</label>
                                            <label><input type="checkbox" name="core-arch-hemosiderin" value="Few"> Few</label>
                                            <label><input type="checkbox" name="core-arch-hemosiderin" value="Numerous"> Numerous</label>
                                        </div>
                                    </div>

                                    <div class="descriptor-category">
                                        <h6>Other Findings</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="core-arch-other" value="Granulomas"> Granulomas</label>
                                            <label><input type="checkbox" name="core-arch-other" value="Hemophagocytosis"> Hemophagocytosis</label>
                                            <label><input type="checkbox" name="core-arch-other" value="Mast cell aggregates/increase"> Mast cell aggregates/increase</label>
                                            <label><input type="checkbox" name="core-arch-other" value="Necrosis"> Necrosis</label>
                                            <label><input type="checkbox" name="core-arch-other" value="Osteosclerosis"> Osteosclerosis</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aspirate Section -->
            <div class="section-card" id="aspirate-section">
                <div class="section-header">
                    <h2>Aspirate</h2>
                </div>
                <div class="section-content">
                    <div class="subsection">
                        <h3>Adequacy</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Aspirate cellularity</label>
                                    <div class="radio-group">
                                        <label><input type="radio" name="aspirate-cellularity" value="Adequate"> Adequate</label>
                                        <label><input type="radio" name="aspirate-cellularity" value="Limited" checked> Limited</label>
                                        <label><input type="radio" name="aspirate-cellularity" value="Inadequate"> Inadequate</label>
                                    </div>
                            </div>
                            <div class="form-group">
                                <label>Spicules</label>
                                <div class="radio-group">
                                    <label><input type="radio" name="spicules" value="Present"> Present</label>
                                    <label><input type="radio" name="spicules" value="Absent"> Absent</label>
                                    <label><input type="radio" name="spicules" value="Scant"> Scant</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Touch prep</label>
                                <div class="radio-group">
                                    <label><input type="radio" name="touch-prep" value="Adequate"> Adequate</label>
                                    <label><input type="radio" name="touch-prep" value="Limited"> Limited</label>
                                    <label><input type="radio" name="touch-prep" value="Inadequate"> Inadequate</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Aspirate - Cell Populations -->
                    <div class="subsection">
                        <h3>Cell Populations</h3>
                        
                        <!-- Detailed Descriptors Toggle -->
                        <div class="form-group">
                            <label class="toggle-label">
                                <input type="checkbox" id="aspirate-abnormal-toggle" class="abnormal-toggle">
                                <span class="toggle-text">Show Detailed Descriptors</span>
                            </label>
                        </div>
                        
                        <!-- Aspirate - Megakaryocytes -->
                        <div class="cell-type-section" id="aspirate-megakaryocytes">
                            <h4>Megakaryocytes</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Megakaryocytes</label>
                                    <div class="radio-group">
                                        <label><input type="radio" name="aspirate-megakaryocytes" value="adequate"> adequate</label>
                                        <label><input type="radio" name="aspirate-megakaryocytes" value="decreased"> decreased</label>
                                        <label><input type="radio" name="aspirate-megakaryocytes" value="increased" checked> increased</label>
                                        <label><input type="radio" name="aspirate-megakaryocytes" value="maturation is complete and without significant abnormalities"> maturation is complete and without significant abnormalities</label>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Detailed Aspirate Megakaryocyte Descriptors -->
                            <div class="descriptor-section collapsible" id="aspirate-megakaryocyte-descriptors">
                                <div class="section-header-toggle">
                                    <h5>ðŸ“‹ Detailed Descriptors</h5>
                                    <button class="toggle-btn" data-target="aspirate-megakaryocyte-descriptors">â–¼</button>
                                </div>
                                <div class="collapsible-content">
                                    <div class="descriptor-category">
                                        <h6>Cell Size & Number</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="aspirate-meg-size" value="Small / Micromegakaryocytes"> Small / Micromegakaryocytes</label>
                                            <label><input type="checkbox" name="aspirate-meg-size" value="Large / Giant megakaryocytes"> Large / Giant megakaryocytes</label>
                                             <label><input type="checkbox" name="aspirate-meg-size" value="Increased megakaryocyte density"> Increased megakaryocyte density</label>
                                             <label><input type="checkbox" name="aspirate-meg-size" value="Decreased megakaryocyte density"> Decreased megakaryocyte density</label>
                                             <label><input type="checkbox" name="aspirate-meg-size" value="Clustered distribution"> Clustered distribution</label>
                                             <label><input type="checkbox" name="aspirate-meg-size" value="Scattered distribution"> Scattered distribution</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Nuclear Features</h6>
                                        <div class="checkbox-grid compact">
                                             <label><input type="checkbox" name="aspirate-meg-nuclear" value="Hypolobated nuclei"> Hypolobated nuclei</label>
                                             <label><input type="checkbox" name="aspirate-meg-nuclear" value="Monolobated nuclei"> Monolobated nuclei</label>
                                            <label><input type="checkbox" name="aspirate-meg-nuclear" value="Hyperlobated nuclei"> Hyperlobated nuclei</label>
                                             <label><input type="checkbox" name="aspirate-meg-nuclear" value="Round nuclei"> Round nuclei</label>
                                             <label><input type="checkbox" name="aspirate-meg-nuclear" value="Oval nuclei"> Oval nuclei</label>
                                            <label><input type="checkbox" name="aspirate-meg-nuclear" value="Bulbous nuclear projections"> Bulbous nuclear projections</label>
                                            <label><input type="checkbox" name="aspirate-meg-nuclear" value="Separated nuclear lobes (pawn ball appearance)"> Separated nuclear lobes ("pawn ball" appearance)</label>
                                            <label><input type="checkbox" name="aspirate-meg-nuclear" value="Irregular nuclear contours"> Irregular nuclear contours</label>
                                             <label><input type="checkbox" name="aspirate-meg-nuclear" value="Hyperchromatic chromatin"> Hyperchromatic chromatin</label>
                                             <label><input type="checkbox" name="aspirate-meg-nuclear" value="Open chromatin"> Open chromatin</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Cytoplasmic Features</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="aspirate-meg-cytoplasm" value="Basophilic cytoplasm"> Basophilic cytoplasm</label>
                                            <label><input type="checkbox" name="aspirate-meg-cytoplasm" value="Pale or granular cytoplasm"> Pale or granular cytoplasm</label>
                                             <label><input type="checkbox" name="aspirate-meg-cytoplasm" value="Abundant cytoplasm"> Abundant cytoplasm</label>
                                             <label><input type="checkbox" name="aspirate-meg-cytoplasm" value="Scant cytoplasm"> Scant cytoplasm</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Other</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="aspirate-meg-other" value="Dysplastic megakaryocytes"> Dysplastic megakaryocytes</label>
                                            <label><input type="checkbox" name="aspirate-meg-other" value="Bare megakaryocyte nuclei (naked nuclei)"> Bare megakaryocyte nuclei (naked nuclei)</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="aspirate-megakaryocyte-description">Additional megakaryocyte description</label>
                                <textarea id="aspirate-megakaryocyte-description" placeholder="Additional findings or specific observations"></textarea>
                            </div>
                        </div>
                        
                        <!-- Aspirate - Erythroid Lineage -->
                        <div class="cell-type-section" id="aspirate-erythroid">
                            <h4>Erythroid Lineage</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Erythroid lineage</label>
                                    <div class="radio-group">
                                        <label><input type="radio" name="aspirate-erythroid" value="complete"> complete</label>
                                        <label><input type="radio" name="aspirate-erythroid" value="left-shifted"> left-shifted</label>
                                        <label><input type="radio" name="aspirate-erythroid" value="dysplastic/atypical" checked> dysplastic/atypical</label>
                                        <label><input type="radio" name="aspirate-erythroid" value="maturation is complete and without significant abnormalities"> maturation is complete and without significant abnormalities</label>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Detailed Aspirate Erythroid Descriptors -->
                            <div class="descriptor-section collapsible" id="aspirate-erythroid-descriptors">
                                <div class="section-header-toggle">
                                    <h5>ðŸ“‹ Detailed Descriptors</h5>
                                    <button class="toggle-btn" data-target="aspirate-erythroid-descriptors">â–¼</button>
                                </div>
                                <div class="collapsible-content">
                                    <div class="descriptor-category">
                                        <h6>Cell Size & Shape</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="aspirate-ery-size" value="Normoblastic maturation"> Normoblastic maturation</label>
                                            <label><input type="checkbox" name="aspirate-ery-size" value="Megaloblastic change (large cells with open chromatin)"> Megaloblastic change (large cells with open chromatin)</label>
                                             <label><input type="checkbox" name="aspirate-ery-size" value="Microcytic erythroblasts"> Microcytic erythroblasts</label>
                                             <label><input type="checkbox" name="aspirate-ery-size" value="Macrocytic erythroblasts"> Macrocytic erythroblasts</label>
                                            <label><input type="checkbox" name="aspirate-ery-size" value="Irregular nuclear shapes (nuclear budding, multinuclearity)"> Irregular nuclear shapes (nuclear budding, multinuclearity)</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Nuclear Features</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="aspirate-ery-nuclear" value="Open chromatin with nucleoli (immature)"> Open chromatin with nucleoli (immature)</label>
                                            <label><input type="checkbox" name="aspirate-ery-nuclear" value="Hyperchromatic nuclei"> Hyperchromatic nuclei</label>
                                            <label><input type="checkbox" name="aspirate-ery-nuclear" value="Fragmented nuclei"> Fragmented nuclei</label>
                                            <label><input type="checkbox" name="aspirate-ery-nuclear" value="Nuclear budding / bridging"> Nuclear budding / bridging</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Cytoplasmic Features</h6>
                                        <div class="checkbox-grid compact">
                                             <label><input type="checkbox" name="aspirate-ery-cytoplasm" value="Basophilic cytoplasm"> Basophilic cytoplasm</label>
                                             <label><input type="checkbox" name="aspirate-ery-cytoplasm" value="Polychromatic cytoplasm"> Polychromatic cytoplasm</label>
                                             <label><input type="checkbox" name="aspirate-ery-cytoplasm" value="Orthochromatic cytoplasm"> Orthochromatic cytoplasm</label>
                                            <label><input type="checkbox" name="aspirate-ery-cytoplasm" value="Vacuolated cytoplasm"> Vacuolated cytoplasm</label>
                                            <label><input type="checkbox" name="aspirate-ery-cytoplasm" value="Reduced hemoglobinization (hypochromia)"> Reduced hemoglobinization (hypochromia)</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Maturation Pattern</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="aspirate-ery-maturation" value="Dyserythropoiesis"> Dyserythropoiesis</label>
                                            <label><input type="checkbox" name="aspirate-ery-maturation" value="Shift to early or late precursors"> Shift to early or late precursors</label>
                                            <label><input type="checkbox" name="aspirate-ery-maturation" value="Disordered maturation"> Disordered maturation</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="aspirate-erythroid-description">Additional erythroid description</label>
                                <textarea id="aspirate-erythroid-description" placeholder="Additional findings or specific observations"></textarea>
                            </div>
                        </div>
                        
                        <!-- Aspirate - Myeloid Lineage -->
                        <div class="cell-type-section" id="aspirate-myeloid">
                            <h4>Myeloid Lineage</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Myeloid lineage</label>
                                    <div class="radio-group">
                                        <label><input type="radio" name="aspirate-myeloid" value="complete"> complete</label>
                                        <label><input type="radio" name="aspirate-myeloid" value="left-shifted"> left-shifted</label>
                                        <label><input type="radio" name="aspirate-myeloid" value="dysplastic/atypical" checked> dysplastic/atypical</label>
                                        <label><input type="radio" name="aspirate-myeloid" value="maturation is complete and without significant abnormalities"> maturation is complete and without significant abnormalities</label>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Detailed Aspirate Myeloid Descriptors -->
                            <div class="descriptor-section collapsible" id="aspirate-myeloid-descriptors">
                                <div class="section-header-toggle">
                                    <h5>ðŸ“‹ Detailed Descriptors</h5>
                                    <button class="toggle-btn" data-target="aspirate-myeloid-descriptors">â–¼</button>
                                </div>
                                <div class="collapsible-content">
                                    <div class="descriptor-category">
                                        <h6>Cellularity & Maturation</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="aspirate-myel-cellularity" value="Left shift (increased early myeloid precursors)"> Left shift (increased early myeloid precursors)</label>
                                            <label><input type="checkbox" name="aspirate-myel-cellularity" value="Maturation arrest"> Maturation arrest</label>
                                            <label><input type="checkbox" name="aspirate-myel-cellularity" value="Normal trilineage hematopoiesis"> Normal trilineage hematopoiesis</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Nuclear Features</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="aspirate-myel-nuclear" value="Hyposegmentation (e.g., pseudoâ€“Pelger-HuÃ«t anomaly)"> Hyposegmentation (e.g., pseudoâ€“Pelger-HuÃ«t anomaly)</label>
                                            <label><input type="checkbox" name="aspirate-myel-nuclear" value="Hypersegmentation"> Hypersegmentation</label>
                                            <label><input type="checkbox" name="aspirate-myel-nuclear" value="Irregular nuclear shapes"> Irregular nuclear shapes</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Cytoplasmic Features</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="aspirate-myel-cytoplasm" value="Hypogranular cytoplasm"> Hypogranular cytoplasm</label>
                                            <label><input type="checkbox" name="aspirate-myel-cytoplasm" value="Toxic granulation"> Toxic granulation</label>
                                            <label><input type="checkbox" name="aspirate-myel-cytoplasm" value="Auer rods (pathologic finding)"> Auer rods (pathologic finding)</label>
                                            <label><input type="checkbox" name="aspirate-myel-cytoplasm" value="Cytoplasmic vacuolization"> Cytoplasmic vacuolization</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Other</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="aspirate-myel-other" value="Dysmyelopoiesis"> Dysmyelopoiesis</label>
                                            <label><input type="checkbox" name="aspirate-myel-other" value="Abnormal granule distribution"> Abnormal granule distribution</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="aspirate-myeloid-description">Additional myeloid description</label>
                                <textarea id="aspirate-myeloid-description" placeholder="Additional findings or specific observations"></textarea>
                            </div>
                        </div>
                        
                        <!-- Aspirate - Lymphocytes & Plasma Cells -->
                        <div class="cell-type-section" id="aspirate-lymphocytes">
                            <h4>Lymphocytes & Plasma Cells</h4>
                            
                            <!-- Detailed Aspirate Lymphocytes Descriptors -->
                            <div class="descriptor-section collapsible" id="aspirate-lymphocytes-descriptors">
                                <div class="section-header-toggle">
                                    <h5>ðŸ“‹ Detailed Descriptors</h5>
                                    <button class="toggle-btn" data-target="aspirate-lymphocytes-descriptors">â–¼</button>
                                </div>
                                <div class="collapsible-content">
                                    <div class="descriptor-category">
                                        <h6>Cell Size & Type</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="aspirate-lymph-size" value="Small mature lymphocytes"> Small mature lymphocytes</label>
                                            <label><input type="checkbox" name="aspirate-lymph-size" value="Intermediate / large lymphoid cells"> Intermediate / large lymphoid cells</label>
                                            <label><input type="checkbox" name="aspirate-lymph-size" value="Reactive lymphocytes"> Reactive lymphocytes</label>
                                            <label><input type="checkbox" name="aspirate-lymph-size" value="Atypical lymphocytes"> Atypical lymphocytes</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Nuclear Features</h6>
                                        <div class="checkbox-grid compact">
                                             <label><input type="checkbox" name="aspirate-lymph-nuclear" value="Round nuclear contours"> Round nuclear contours</label>
                                             <label><input type="checkbox" name="aspirate-lymph-nuclear" value="Irregular nuclear contours"> Irregular nuclear contours</label>
                                            <label><input type="checkbox" name="aspirate-lymph-nuclear" value="Clumped chromatin (typical of mature cells)"> Clumped chromatin (typical of mature cells)</label>
                                            <label><input type="checkbox" name="aspirate-lymph-nuclear" value="Open chromatin with nucleoli (atypical / blasts)"> Open chromatin with nucleoli (atypical / blasts)</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Cytoplasmic Features</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="aspirate-lymph-cytoplasm" value="Scant basophilic cytoplasm (small lymphocytes)"> Scant basophilic cytoplasm (small lymphocytes)</label>
                                            <label><input type="checkbox" name="aspirate-lymph-cytoplasm" value="Perinuclear hof (plasma cells)"> Perinuclear hof (plasma cells)</label>
                                            <label><input type="checkbox" name="aspirate-lymph-cytoplasm" value="Plasmacytoid features"> Plasmacytoid features</label>
                                        </div>
                                    </div>
                                    
                                    <div class="descriptor-category">
                                        <h6>Distribution</h6>
                                        <div class="checkbox-grid compact">
                                            <label><input type="checkbox" name="aspirate-lymph-distribution" value="Interstitial, nodular, paratrabecular, diffuse aggregates"> Interstitial, nodular, paratrabecular, diffuse aggregates</label>
                                            <label><input type="checkbox" name="aspirate-lymph-distribution" value="Monoclonal vs polyclonal plasma cells (immunostaining required)"> Monoclonal vs polyclonal plasma cells (immunostaining required)</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="aspirate-lymphocytes-description">Additional lymphocytes & plasma cells description</label>
                                <textarea id="aspirate-lymphocytes-description" placeholder="Additional findings or specific observations"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Report Controls -->
            <div class="section-card">
                <div class="section-header">
                    <h2>Generate Report</h2>
                </div>
                <div class="section-content">
                    <div class="form-row">
                        <button id="generate-report" class="btn btn-primary">Generate Report</button>
                        <button id="copy-report" class="btn btn-secondary">Copy to Clipboard</button>
                        <button id="clear-form" class="btn btn-secondary">Clear Form</button>
                    </div>
                    
                    <div class="form-group">
                        <label for="report-output">Generated Report:</label>
                        <textarea id="report-output" rows="20" placeholder="Click 'Generate Report' to create your report here..."></textarea>
                    </div>
                    
                    <div class="form-row">
                        <button onclick="exportReport('txt')" class="btn btn-secondary">Export as TXT</button>
                        <button onclick="printReport()" class="btn btn-secondary">Print Report</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
